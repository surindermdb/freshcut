(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{52925:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return n(18638)}])},74217:function(e,t,n){"use strict";var r=n(85893),o=n(67294),a=n(24708),i=n(50490),s=n(8294),c=n(13607),u=n(2186),l=n(63318),d=n(76645),f=n(85691),p=n(643),h=n(34010),v=n(56776),g=n(11163);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(c){s=!0,o=c}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.Z=function(e){var t=e.orders,n=e.onPrint,m=e.onPrintSlips,b=e.meta,x=e.onPageChange,j=e.onSortChange,w=e.openNewTab,C=[];t.forEach((function(e){var t;if(e.delivery)if("asap"==e.delivery)t="ASAP";else{var n="Not set";void 0!=e.arriveByDate&&(n=function(e){var t=y(e.split("T"),2),n=t[0],r=t[1],o=y(n.match(/\d+/g),3),a=o[0],i=o[1],s=o[2],c=y(r.split(/(?=[+-])/),2),u=c[0];return c[1],"".concat(i,"/").concat(s,"/").concat(a," ").concat(u)}(e.arriveByDate)),t=n}else t="Not defined";var r=e.orderName,o=e.orderId,a={id:e._id,orderId:o,orderName:e.orderName,orderNameUpdate:r,customer:e.firstName+" "+e.lastName,address:e.deliverTo,shipDate:t,message:e.message,font:e.font,design:e.design,status:"fulfilled"==e.status?"Printed":"Unprinted"};C.push(a)}));var S=(0,a.T)(C),P=S.selectedResources,O=S.allResourcesSelected,_=S.handleSelectionChange,k=(0,o.useState)(null),A=k[0],N=k[1],I=(0,o.useState)(null),R=(I[0],I[1]),E=(0,o.useState)("status_unfulfilled"),T=E[0],Z=E[1];(0,o.useEffect)((function(){}));var D,q=C.map((function(e,t){var n=e.orderName,o=e.orderNameUpdate,a=e.customer,l=e.shipDate,d=e.status,f=e.address,p=e.id,m=e.order,y=e.orderId,b=e.message,x=e.font,j=e.design;return(0,r.jsxs)(i.m.Row,{id:p,selected:P.includes(p),position:t,children:[(0,r.jsx)(i.m.Cell,{style:{position:"relative"},children:o}),(0,r.jsxs)(i.m.Cell,{children:[(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:a})}),(0,r.jsx)("p",{children:f})]}),(0,r.jsx)(i.m.Cell,{children:l}),(0,r.jsx)(i.m.Cell,{children:(0,r.jsx)(s.C,{status:"Printed"==d?"success":"new",children:d})}),(0,r.jsxs)(i.m.Cell,{children:[(0,r.jsx)(c.u,{content:"Edit",children:(0,r.jsx)(u.z,{size:"slim",icon:h.S,plain:!0,onClick:function(){return g.default.push({pathname:"/orders/edit",query:{id:p,order:JSON.stringify({orderName:n,customer:a,shipDate:l,status:d,address:f,id:p,order:m,orderId:y,message:b,font:x,design:j})}})}})}),(0,r.jsx)(c.u,{content:"Open order",children:(0,r.jsx)(u.z,{size:"slim",icon:v.S,plain:!0,onClick:function(){return w("admin/orders/".concat(y))}})})]})]},p)})),B=((0,o.useCallback)((function(e){return N(e)}),[]),(0,o.useCallback)((function(){return N(null)}),[])),U=(0,o.useCallback)((function(){return R(null)}),[]),z=((0,o.useCallback)((function(){B(),U()}),[U,B]),(0,o.useCallback)((function(e){Z(e),j(1,e)}),[])),M=[{content:"Generate Print File",onAction:function(){return n(P)}}],W=[{content:"Print packaging slips",onAction:function(){return m(P)}}];return l.n,D=A,(Array.isArray(D)?0===D.length:""===D||null==D)||function(e,t){"taggedWith"===e&&"Tagged with ".concat(t)}("taggedWith",A),(0,r.jsxs)(d.Z,{children:[(0,r.jsx)("div",{style:{padding:"16px",display:"flex",justifyContent:"end"},children:(0,r.jsx)("div",{style:{paddingLeft:"0.4rem"},children:(0,r.jsx)(f.P,{labelInline:!0,label:"Sort by",options:[{label:"Status Unprinted",value:"status_unfulfilled"},{label:"Status Printed",value:"status_fulfilled"}],value:T,onChange:z})})}),(0,r.jsx)(i.m,{resourceName:{singular:"customer",plural:"customers"},itemCount:C.length,selectedItemsCount:O?"All":P.length,onSelectionChange:_,hasMoreItems:!0,bulkActions:W,promotedBulkActions:M,headings:[{title:"Order"},{title:"Customer / Shipping Address"},{title:"Order Date"},{title:"Status"},{title:"Actions"}],children:q}),(0,r.jsx)(p.t,{hasPrevious:"1"!=b.page,onPrevious:function(){x(parseInt(b.page)-1,T)},hasNext:b.pages!=parseInt(b.page),onNext:function(){x(parseInt(b.page)+1,T)}})]})}},57915:function(e,t,n){"use strict";n(85893),n(67294),n(11163)},36453:function(e,t,n){"use strict";var r=new(n(34675).Z);t.Z={fetchAll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"status_unfulfilled";return r.request.get("/orders?page=".concat(e,"&sort=").concat(t))},fetchSingle:function(e){return r.request.get("/orders/".concat(e))},printCard:function(e){return r.request.get("/orders/print?orders=".concat(e))},printPackagingSlips:function(e){return r.request.get("/orders/print-slips?orders=".concat(e))},update:function(e,t){return r.request.patch("/orders/".concat(e),t)}}},18638:function(e,t,n){"use strict";n.r(t);var r=n(34051),o=n.n(r),a=n(85893),i=n(67294),s=n(5602),c=n(76645),u=n(36453),l=(n(57915),n(74217)),d=n(58923);function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,s,"next",e)}function s(e){p(a,r,o,i,s,"throw",e)}i(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function y(e,t){return!t||"object"!==x(t)&&"function"!==typeof t?f(e):t}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}var x=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var o=m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}var w=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(p,e);var t,n,r,i=j(p);function p(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),g(f(e=i.call(this)),"redirectTo",(function(e){d.Redirect.create(AppContainer).dispatch(d.Redirect.Action.REMOTE,{url:"".concat(AppContainer.localOrigin,"/public/widget/").concat(e),newContext:!0})}));var t=f(e);return g(f(e),"handlePrintPdf",function(){var e=h(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.Z.printCard(order._id);case 3:r=e.sent,console.log({data:r,props:t.props}),t.props.redirectTo(r.data.payload.file),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),e.state={orders:[],meta:null,currentPage:0,fetchingOrders:!1,pageIsReady:!1},e}return t=p,n=[{key:"componentDidMount",value:function(){var e=this;return h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchOrders();case 2:e.setState({pageIsReady:!0});case 3:case"end":return t.stop()}}),t)})))()}},{key:"fetchOrders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;return h(o().mark((function n(){var r,a,i,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.state.currentPage){n.next=2;break}return n.abrupt("return");case 2:return t.setState({fetchingOrders:!0}),n.prev=3,n.next=6,u.Z.fetchAll();case 6:r=n.sent,a=r.data,i=a.payload,s=a.meta,t.setState({orders:i,meta:s,currentPage:e}),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(3),console.log(n.t0);case 16:return n.prev=16,t.setState({fetchingCards:!1}),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[3,13,16,19]])})))()}},{key:"render",value:function(){var e=this.state;return e.orders,e.meta,e.pageIsReady,(0,a.jsx)(s.T,{title:"Orders",separator:!0,children:(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(c.Z.Header,{}),(0,a.jsx)(c.Z.Section,{children:(0,a.jsx)(l.Z,{})})]})})}}],n&&v(t.prototype,n),r&&v(t,r),p}(i.Component);t.default=w}},function(e){e.O(0,[602,318,286,774,888,179],(function(){return t=52925,e(e.s=t);var t}));var t=e.O();_N_E=t}]);